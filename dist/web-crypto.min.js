/*!
WebCrypto v0.0.1 
(c) 2015 Samuel Samtleben 
License: MIT 
*/

!function(a,b){"function"==typeof define&&define.amd?define(["asmCrypto"],b):"object"==typeof exports?module.exports=b(require("asmCrypto")):a.webCrypto=b(a.asmCrypto)}(this,function(a){function b(a,b,c,d,e){Object.defineProperties(this,{type:{value:a,enumerable:!0},extractable:{value:b,enumerable:!0},algorithm:{value:c,enumerable:!0},usages:{value:d,enumerable:!0},_handle:{value:e,enumerable:!0}})}function c(a){var c="Conversion of key with algorithm '"+a.algorithm.name+"' not supported";if(Ja(a))return Promise.resolve(a);if(O("exportKey",a.algorithm)){var d=a.extractable;d||(a=new b(a.type,!0,a.algorithm,a.usages,a._handle));var e=H(a.algorithm,"import",a.type);return e.length>0?X(e[0],a).then(function(b){return Y(e[0],b,a.algorithm,d,a.usages)}).then(function(a){if(!Ja(a))throw new NotSupportedError(c);return a}):Promise.reject(new NotSupportedError(c))}return Promise.reject(new NotSupportedError(c))}function d(a){if(Ka(a))return Promise.resolve(a);var b;return b="secret"===a.type?"raw":"jwk",W(b,a).then(function(c){return Z(b,c,a.algorithm,a.extractable,a.usages)})}function e(b){if(Qa)Qa.getRandomValues(b);else{if(!a)throw new NotSupportedError("Function 'getRandomValues' not supported");a.getRandomValues(b)}return b}function f(a,b,c,d,e,f){return new Promise(function(g,h){Da(d)&&(d=la(d,!0)),Da(e)&&(e=la(e,!0)),Y("raw",d,{name:"PBKDF2"},!0,["deriveKey"]).then(function(d){return ga({name:"PBKDF2",salt:e,iterations:f,hash:{name:"SHA-256"}},d,a,b,c)}).then(function(a){g(a)})["catch"](function(a){h(a)})})}function g(a,b){return new Promise(function(c,d){Da(b)&&(b=la(b)),S({name:a},b).then(function(a){c(new Uint8Array(a))})["catch"](function(a){d(a)})})}function h(a){return g("SHA-256",a).then(function(a){return na(a)})}function i(a){return g("SHA-256",a).then(function(a){return pa(a)})}function j(){this.iv,this.additionalData,this.tagLength}function k(b,c,d){if(d.byteLength>Math.pow(2,39)-256)throw new OperationError('"data" too large');if(b.iv.byteLength>Math.pow(2,64)-1)throw new OperationError('"iv" too large');var e;if(void 0===b.tagLength)e=128;else{if(32!==b.tagLength&&64!==b.tagLength&&96!==b.tagLength&&104!==b.tagLength&&112!==b.tagLength&&120!==b.tagLength&&128!==b.tagLength)throw new OperationError('Invalid "tagLength"');e=b.tagLength}var f;f=void 0===b.additionalData?new ArrayBuffer(0):Ba(b.additionalData);var g=a.AES_GCM.encrypt(Ba(d),c._handle,Ba(b.iv),f,e/8);return new Uint8Array(g).buffer}function l(b,c,d){var e;if(void 0===b.tagLength)e=128;else{if(32!==b.tagLength&&64!==b.tagLength&&96!==b.tagLength&&104!==b.tagLength&&112!==b.tagLength&&120!==b.tagLength&&128!==b.tagLength)throw new OperationError('Invalid "tagLength"');e=b.tagLength}if(8*d.byteLength<e)throw new OperationError("The provided data is too small");if(b.iv.byteLength>Math.pow(2,64)-1)throw new OperationError('"iv" is too large');if(b.additionalData&&b.additionalData.byteLength>Math.pow(2,64)-1)throw new OperationError('"additionalData" is too large');var f;f=void 0===b.additionalData?new ArrayBuffer(0):Ba(b.additionalData);var g=a.AES_GCM.decrypt(Ba(d),c._handle,Ba(b.iv),f,e/8);return new Uint8Array(g).buffer}function m(){this.length}function n(a,c,d){if(xa(d,["encrypt","decrypt","wrapKey","unwrapKey"]))throw new SyntaxError("Cannot create a key using the specified key usages.");if(128!==a.length&&192!==a.length&&256!==a.length)throw new OperationError("AES key length must be 128, 192 or 256 bits");var f;try{var g=new Uint8Array(a.length/8);e(g);var h={name:a.name,length:a.length};f=new b("secret",c,h,d,g.buffer)}catch(i){throw new OperationError(i)}return f}function o(a,b){var c;if("jwk"===a){var d={};d.kty="oct",d.k=na(new Uint8Array(b._handle)),d.alg=K(b.algorithm),d.key_ops=b.usages,d.ext=b.extractable,c=d}else{if("raw"!==a)throw new NotSupportedError('Format "'+a+'" not supported');var e=b._handle;if(!Aa(e))throw new OperationError("Invalid key format.");c=Ba(e)}return c}function p(a,c,d,e,f){if(xa(f,["encrypt","decrypt","wrapKey","unwrapKey"]))throw new SyntaxError("Cannot create a key using the specified key usages.");var g;if("raw"===a){if(!Aa(c))throw new DataError("Key data must be a BufferSource for non-JWK formats");if(g=Ba(c),16!==g.byteLength&&24!==g.byteLength&&32!==g.byteLength)throw new DataError("AES key data must be 128, 192 or 256 bits")}else{if("jwk"!==a)throw new NotSupportedError('Format "'+a+'" not supported');var h=c;if("oct"!==h.kty)throw new DataError('The JWK "kty" member was not "oct"');if(!h.k)throw new DataError("JWK does not meet the requirements");if(g=oa(h.k).buffer,h.alg){var i=L(h.alg);if(i.length!==8*g.byteLength)throw new DataError('The JWK "alg" member was inconsistent with that specified by the Web Crypto call')}if(h.use&&"enc"!==h.use)throw new DataError('The JWK "use" member was not "enc"');if(h.key_ops&&xa(f,h.key_ops))throw new DataError('The JWK "key_ops" member does not contain all of the specified usages values.');if(void 0!==h.ext&&h.ext===!1&&e)throw new DataError('The JWK "ext" member was inconsistent with that specified by the Web Crypto call')}var j={name:d.name,length:8*g.byteLength};return new b("secret",!1,j,[],g)}function q(a){if(128!==a.length&&192===a.length&&256===a.length)throw new OperationError("Invalid key length. Must be 128, 192 or 256");return a.length}function r(){this.salt,this.iterations,this.hash}function s(a,c,d,e,f){if("raw"!==a)throw new NotSupportedError('Format "'+a+'" not supported');if(xa(f,["deriveKey","deriveBits"]))throw new SyntaxError("Cannot create a key using the specified key usages.");if(!Aa(c))throw new DataError('"keyData" does not meet requirements');var g=Ba(c),h=new G("PBKDF2");return new b("secret",!1,h,[],g)}function t(a,b){var c;if("raw"!==a)throw new NotSupportedError('Format "'+a+'" not supported');var d=b._handle;if(!Aa(d))throw new OperationError("Invalid key format.");return c=Ba(d)}function u(b,c,d){if(d%8!==0)throw new OperationError('"length" must be a multiple of 8');P("digest",b.hash);var e;switch(b.hash.name){case"SHA-1":e=a.PBKDF2_HMAC_SHA1.bytes(Ba(c._handle),Ba(b.salt),b.iterations,d/8);break;case"SHA-256":e=a.PBKDF2_HMAC_SHA256.bytes(Ba(c._handle),Ba(b.salt),b.iterations,d/8);break;case"SHA-512":e=a.PBKDF2_HMAC_SHA512.bytes(Ba(c._handle),Ba(b.salt),b.iterations,d/8);break;default:throw new NotSupportedError('PBKDF2 with hash "'+b.hash.name+'" not supported')}return e}function v(){this.label}function w(b,c,d){if("public"!==c.type)throw new InvalidAccessError("key.usages does not permit this operation");var e;e=void 0===b.label?new ArrayBuffer(0):Ba(b.label);var f;switch(c.algorithm.hash.name){case"SHA-256":f=a.RSA_OAEP_SHA256.encrypt;break;default:throw new NotSupportedError("Not supported yet: hash: "+c.algorithm.hash.name)}try{var g=f(Ba(d),c._handle,e)}catch(h){throw new OperationError(h)}return new Uint8Array(g).buffer}function x(b,c,d){if("private"!==c.type)throw new InvalidAccessError("key.usages does not permit this operation");var e;e=void 0===b.label?new ArrayBuffer(0):Ba(b.label);var f;switch(c.algorithm.hash.name){case"SHA-256":f=a.RSA_OAEP_SHA256.decrypt;break;default:throw new NotSupportedError("Not supported yet: hash: "+c.algorithm.hash.name)}try{var g=f(Ba(d),c._handle,e)}catch(h){throw new OperationError(h)}return new Uint8Array(g).buffer}function y(){this.modulusLength,this.publicExponent}function z(){this.hash}function A(){this.hash}function B(c,d,e){if(xa(e,["encrypt","decrypt","wrapKey","unwrapKey"]))throw new SyntaxError("Cannot create a key using the specified key usages.");try{var f=a.RSA.generateKey(c.modulusLength,c.publicExponent)}catch(g){throw new OperationError(g)}var h={};h.name=c.name,h.modulusLength=c.modulusLength,h.publicExponent=c.publicExponent,h.hash=c.hash;var i=new b("public",!0,h,ya(e,["encrypt","wrapKey"]),[f[0],f[1]]),j=new b("private",d,h,ya(e,["decrypt","unwrapKey"]),f),k={publicKey:i,privateKey:j};return k}function C(a,b){var c;if("jwk"!==a)throw new NotSupportedError("Export format '"+a+"' not supported by algorithm '"+b.algorithm.name+"'");var d={};return d.kty="RSA",d.alg=K(b.algorithm),d.n=na(b._handle[0]),d.e=na(b._handle[1]),"private"===b.type&&(d.d=na(b._handle[2]),d.p=na(b._handle[3]),d.q=na(b._handle[4]),d.dp=na(b._handle[5]),d.dq=na(b._handle[6]),d.qi=na(b._handle[7])),d.key_ops=b.usages,d.ext=b.extractable,c=d}function D(a,c,d,e,f){var g,h;if("jwk"!==a)throw new NotSupportedError('Format "'+a+'" not yet supported');var i=c;if(i.d&&xa(f,["decrypt","unwrapKey"])||!i.d&&xa(f,["encrypt","wrapKey"]))throw new SyntaxError("Cannot create a key using the specified key usages.");if(!c.kty)throw new SyntaxError('The required JWK member "kty" was missing');if("RSA"!==c.kty)throw new DataError('The JWK "kty" member was not "RSA"');if(i.use&&"enc"!==i.use)throw new DataError('The JWK "use" member was not "enc"');if(i.key_ops&&xa(f,i.key_ops))throw new DataError('The JWK "key_ops" member does not contain all of the specified usages values.');if(i.alg){var j=L(i.alg);if(j.name!==d.name||!j.hash)throw new DataError('The JWK "alg" member was inconsistent with that specified by the Web Crypto call');var k=j.hash.name,l=N("digest",k);if(l.name!==d.hash.name)throw new DataError('The JWK "alg" member was inconsistent with that specified by the Web Crypto call')}if(i.d){if(!(i.n&&i.e&&i.d&&i.p&&i.q&&i.dp&&i.dq&&i.qi))throw new DataError("JWK does not meet the requirements");g=[oa(i.n),oa(i.e),oa(i.d),oa(i.p),oa(i.q),oa(i.dp),oa(i.dq),oa(i.qi)],h="private"}else{if(!i.n||!i.e)throw new DataError("JWK does not meet the requirements");g=[oa(i.n),oa(i.e)],h="public"}var m={};return m.name=d.name,m.modulusLength=8*g[0].length,m.publicExponent=new Uint8Array(g[1]),m.hash=d.hash,new b(h,!1,m,[],g)}function E(b,c){var d;try{var e,f=Ba(c);switch(b.name){case"SHA-1":e=a.SHA1.bytes(f);break;case"SHA-256":e=a.SHA256.bytes(f);break;case"SHA-512":e=a.SHA512.bytes(f)}d=e.buffer}catch(g){throw new OperationError(g.message)}return d}function F(){this.name}function G(a){this.name=a}function H(a,b,c){var d=a.name||a,e=[];if(Ra[d]&&Ra[d][b]&&Ra[d][b][c])for(var f=Ra[d][b][c],g=Object.keys(f),h=0;h<g.length;h++)f[g[h]]&&e.push(g[h]);return e}function I(a,b,c,d){var e=a.name||a;Ra[e]&&Ra[e][b]&&Ra[e][b][c]&&Ra[e][b][c].hasOwnProperty(d)&&(Ra[e][b][c][d]=!1)}function J(a,b,c){var d=a.name||a,e=null;switch(d){case"AES-CTR":case"AES-CBC":case"AES-CMAC":case"AES-GCM":case"AES-CFB":case"AES-KW":case"HMAC":case"CONCAT":case"HKDF-CTR":case"PBKDF2":e="secret";break;case"RSASSA-PKCS1-v1_5":case"RSA-PSS":case"RSA-OAEP":case"ECDSA":case"ECDH":if("pkcs8"===b)e="private";else if("spki"===b)e="public";else if("jwk"===b&&"DH"!==d)e=c.d?"private":"public";else{if("raw"!==b||"ECDH"!==d&&"DH"!==d)throw new NotSupportedError("Format '"+b+"' not supported for algorithm: "+d);e="public"}break;default:throw new NotSupportedError("The algorithm is not supported: "+d)}return e}function K(a){return{HMAC:{"SHA-1":"HS1","SHA-256":"HS256","SHA-384":"HS384","SHA-512":"HS512"},"RSASSA-PKCS1-v1_5":{"SHA-1":"RS1","SHA-256":"RS256","SHA-384":"RS384","SHA-512":"RS512"},"RSAES-PKCS1-v1_5":{"":"RSA1_5"},"RSA-OAEP":{"SHA-1":"RSA-OAEP","SHA-256":"RSA-OAEP-256","SHA-384":"RSA-OAEP-384","SHA-512":"RSA-OAEP-512"},"AES-KW":{128:"A128KW",192:"A192KW",256:"A256KW"},"AES-GCM":{128:"A128GCM",192:"A192GCM",256:"A256GCM"},"AES-CBC":{128:"A128CBC",192:"A192CBC",256:"A256CBC"}}[a.name][(a.hash||{}).name||a.length||""]}function L(a){var b=a.match(/\d+/g)||"1",c=a.match(/[A-Z]+/g).join("-"),d={RS:"RSASSA-PKCS1-v1_5",PS:"RSA-PSS","RSA-OAEP":"RSA-OAEP",ES:"ECDSA","A-CTR":"AES-CTR","A-CBC":"AES-CBC","A-KW":"AES-KW","A-GCM":"AES-GCM","A-GCMKW":"AES-GCM",HS:"HMAC"}[c]||"",e={name:d};switch(d){case"RSASSA-PKCS1-v1_5":case"RSA-PSS":case"RSA-OAEP":case"HMAC":e.hash={name:"SHA-"+b};break;case"ECDSA":e.hash={name:"SHA-"+b},e.namedCurve="P-"+("512"===b?"521":b);break;case"AES-CTR":case"AES-CBC":case"AES-KW":case"AES-GCM":e.length=parseInt(b)}return e}function M(a,b){var c=Ta[a];if(!c)throw new NotSupportedError("Unkown method: "+a);return-1!==Ta["default"].indexOf(b)||-1!==c.indexOf(b)}function N(a,b){if(Da(b))return N(a,{name:b});var c=b.name.toUpperCase().replace("V","v");P(a,b);var d;switch(c){case"SHA-1":case"SHA-256":case"SHA-384":case"SHA-512":d=(new F).init(b);break;case"AES-GCM":if("encrypt"===a||"decrypt"===a)d=(new j).init(b);else if("generateKey"===a||"getKeyLength"===a)d=(new m).init(b);else{if("importKey"!==a&&"exportKey"!==a)throw new NotSupportedError("Normalizing '"+c+"' algorithm for op '"+a+"' not supported");d=(new F).init(b)}break;case"RSA-OAEP":if("encrypt"===a||"decrypt"===a||"wrapKey"===a||"unwrapKey"===a)d=(new v).init(b);else if("generateKey"===a)d=(new z).init(b);else{if("importKey"!==a)throw new NotSupportedError("Normalizing '"+c+"' algorithm for op '"+a+"' not supported");d=(new A).init(b)}break;case"PBKDF2":if("importKey"===a)d=(new F).init(b);else{if("deriveBits"!==a)throw new NotSupportedError("Normalizing '"+c+"' algorithm for op '"+a+"' not supported");d=(new r).init(b)}}return d}function O(a,b){var c=b.name||b;return!!Sa[a][c]}function P(a,b){var c=b.name||b;if(!O(a,b))throw new NotSupportedError("The operation '"+a+"' is not supported by algorithm '"+c+"'")}function Q(a,b,c){P(a,b);var d=Sa[a][b.name];return d.apply(this,c)}function R(a){return new Promise(function(b,c){var d=a.call();"function"==typeof d.then?d.then(function(a){b(a)})["catch"](function(a){c(a)}):"oncomplete"in d&&"onerror"in d?(d.oncomplete=function(a){b(a.target.result)},d.onerror=function(a){c(a)}):b(d)})}function S(a,b){return new Promise(function(c,d){function e(){T(a,b).then(function(a){c(a)})["catch"](function(a){d(a)})}La?R(function(){return La.digest(a,b)}).then(function(a){c(a)})["catch"](function(a){M("digest",a.name)?e():d(a)}):e()})}function T(a,b){return new Promise(function(c,d){b=Ca(b);var e=N("digest",a),f=Q("digest",e,[e,b]);c(f)})}function U(a,d,e){return new Promise(function(f,g){function h(){V(a,d,e).then(function(a){La?a instanceof b?c(a).then(function(a){f(a)})["catch"](function(){f(a)}):Promise.all([c(a.privateKey),c(a.publicKey)]).then(function(a){f({privateKey:a[0],publicKey:a[1]})})["catch"](function(){f(a)}):f(a)})["catch"](function(a){g(a)})}La?R(function(){return La.generateKey(a,d,e)}).then(function(a){f(a)})["catch"](function(a){M("generateKey",a.name)?h():g(a)}):h()})}function V(a,c,d){return new Promise(function(e,f){var g=N("generateKey",a),h=Q("generateKey",g,[g,c,d]);if(h instanceof b){if(("secret"===h.type||"private"===h.type)&&0===d.length)throw new SyntaxError("'keyUsages' can not be empty for secret or private key")}else if(!h.privateKey.usages||0===h.privateKey.usages.length)throw new SyntaxError("Private key usages can not be empty");e(h)})}function W(a,b){return Ja(b)?La?R(function(){return La.exportKey(a,b)}).then(function(b){return Oa&&"jwk"===a&&Aa(b)&&(b=JSON.parse(ma(new Uint8Array(b)))),b}):Promise.reject(new NotSupportedError("'key' is native CryptoKey but native Crypto object not available")):Ka(b)?X(a,b):Promise.reject(new DataError('Unknown format of "key"'))}function X(a,b){return new Promise(function(c,d){if(P("exportKey",b.algorithm),!b.extractable)throw new InvalidAccessError("Key is not extractable");var e=Q("exportKey",b.algorithm,[a,b]);c(e)})}function Y(a,b,d,e,f){return new Promise(function(g,h){function i(){Z(a,b,d,e,f).then(function(a){La?c(a).then(function(a){g(a)})["catch"](function(){g(a)}):g(a)})["catch"](function(a){h(a)})}La?R(function(){return La.importKey(a,b,d,e,f)}).then(function(a){g(a)})["catch"](function(c){M("importKey",c.name)?(I(d.name||d,"import",J(d,a,b),a),i()):h(c)}):i()})}function Z(a,c,d,e,f){return new Promise(function(g,h){var i=N("importKey",d);if("raw"===a||"pkcs8"===a||"spki"===a){if(za(c))throw new TypeError("'keyData' is a JsonWebKey");c=Ca(c)}else if("jwk"===a&&!za(c))throw new TypeError("'keyData' is not a JsonWebKey");var j=Q("importKey",i,[a,c,i,e,f]);if(("secret"===j.type||"private"===j.type)&&0===f.length)throw new SyntaxError("'usages' is empty");j=new b(j.type,e,j.algorithm,f,j._handle),g(j)})}function $(a,b,e){return new Promise(function(f,g){function h(){d(b).then(function(b){return _(a,b,e)}).then(function(a){f(a)})["catch"](function(a){g(a)})}La?c(b).then(function(b){return R(function(){return La.encrypt(a,b,e)})}).then(function(a){f(a)})["catch"](function(a){M("encrypt",a.name)?h():g(a)}):h()})}function _(a,b,c){return new Promise(function(d,e){c=Ca(c);var f=N("encrypt",a);if(f.name!==b.algorithm.name)throw new InvalidAccessError("Key not usable with this algorithm");if(-1===b.usages.indexOf("encrypt"))throw new InvalidAccessError("key.usages does not permit this operation");var g=Q("encrypt",f,[f,b,c]);d(g)})}function aa(a,b,e){return new Promise(function(f,g){function h(){d(b).then(function(b){return ba(a,b,e)}).then(function(a){f(a)})["catch"](function(a){g(a)})}La?c(b).then(function(c){return R(function(){return La.decrypt(a,b,e)})}).then(function(a){f(a)})["catch"](function(a){M("decrypt",a.name)?h():g(a)}):h()})}function ba(a,b,c){return new Promise(function(d,e){c=Ca(c);var f=N("decrypt",a);if(f.name!==b.algorithm.name)throw new InvalidAccessError("Key not usable with this algorithm");if(-1===b.usages.indexOf("decrypt"))throw new InvalidAccessError("key.usages does not permit this operation");var g=Q("decrypt",f,[f,b,c]);d(g)})}function ca(a,b,e,f){return new Promise(function(g,h){function i(){Promise.all([d(b),d(e)]).then(function(b){return da(a,b[0],b[1],f)}).then(function(a){g(a)})["catch"](function(a){h(a)})}La?Promise.all([c(b),c(e)]).then(function(b){return Pa?R(function(){return La.wrapKey(a,b[0],b[1],f)}):W(a,b[0]).then(function(c){var d;return d="jwk"===a?va(c):c,$(f,b[1],d)})}).then(function(a){g(a)})["catch"](function(a){M("wrapKey",a.name)?i():h(a)}):i()})}function da(a,b,c,d){return new Promise(function(e,f){try{var g=d,h="wrapKey",i=N(h,g)}catch(j){var h="encrypt";i=N(h,g)}if(P(h,i),i.name!==c.algorithm.name)throw new InvalidAccessError("Key not usable with this algorithm");if(-1===c.usages.indexOf("wrapKey"))throw new InvalidAccessError("wrappingKey.usages does not permit this operation");if(P("exportKey",b.algorithm),!b.extractable)throw new InvalidAccessError("'key' is not extractable");var k,l=Q("exportKey",b.algorithm,[a,b]);k="jwk"===a?va(l):l;var m;if(O("wrapKey",i))m=Q("wrapKey",i,[i,c,k]);else{if(!O("encrypt",i))throw new NotSupportedError("The operation is not supported by algorithm '"+i.name+"'");m=Q("encrypt",i,[i,c,k])}e(m)})}function ea(a,b,e,f,g,h,i){return new Promise(function(j,k){function l(){d(e).then(function(c){return fa(a,b,c,f,g,h,i)}).then(function(a){La?c(a).then(function(a){j(a)})["catch"](function(){j(a)}):j(a)})["catch"](function(a){k(a)})}La?c(e).then(function(c){return Pa?R(function(){return La.unwrapKey(a,b,c,f,g,h,i)}):aa(f,c,b).then(function(b){return"jwk"===a&&(b=wa(new Uint8Array(b))),Y(a,b,g,h,i)})}).then(function(a){j(a)})["catch"](function(a){M("unwrapKey",a.name)?l():k(a)}):l()})}function fa(a,c,d,e,f,g,h){return new Promise(function(i,j){var k=e,l=h;c=Ca(c);try{var m=N("unwrapKey",k)}catch(n){m=N("decrypt",k)}var o=N("importKey",f);if(m.name!==d.algorithm.name)throw new InvalidAccessError("Key not usable with this algorithm");if(-1===d.usages.indexOf("unwrapKey"))throw new InvalidAccessError("unwrappingKey.usages does not permit this operation");var p;if(O("unwrapKey",m))p=Q("unwrapKey",m,[m,d,c]);else{if(!O("decrypt",m))throw new NotSupportedError("The operation is not supported by algorithm '"+m.name+"'");p=Q("decrypt",m,[m,d,c])}var q;q="jwk"===a?wa(new Uint8Array(p)):p;var r=Q("importKey",o,[a,q,o,g,l]);if(!("secret"!==r.type&&"private"!==r.type||l.length&&0!==l.length))throw new SyntaxError("'usages' is empty");r=new b(r.type,g,r.algorithm,l,r._handle),i(r)})}function ga(a,b,e,f,g){return new Promise(function(h,i){function j(){d(b).then(function(b){return ha(a,b,e,f,g)}).then(function(a){La?c(a).then(function(a){h(a)})["catch"](function(){h(a)}):h(a)})["catch"](function(a){i(a)})}Pa&&La?c(b).then(function(b){return R(function(){return La.deriveKey(a,b,e,f,g)})}).then(function(a){h(a)})["catch"](function(a){M("deriveKey",a.name)?j():i(a)}):j()})}function ha(a,c,d,e,f){return new Promise(function(g,h){var i=f,j=N("deriveBits",a),k=N("getKeyLength",d);if(P("deriveBits",j),P("getKeyLength",k),j.name!==c.algorithm.name)throw new InvalidAccessError("Key not usable with this algorithm");if(-1===c.usages.indexOf("deriveKey"))throw new InvalidAccessError("baseKey.usages does not permit this operation");var l=Q("getKeyLength",k,[k]),m=Q("deriveBits",j,[j,c,l]),n=Q("importKey",k,["raw",m,k,e,i]);if(!("secret"!==n.type&&"private"!==n.type||i.length&&0!==i.length))throw new SyntaxError("'usages' is empty");n=new b(n.type,e,n.algorithm,i,n._handle),g(n)})}function ia(a,b,c){return new Promise(function(e,f){function g(){d(b).then(function(b){return ja(a,b,c)}).then(function(a){e(a)})["catch"](function(a){f(a)})}return Pa&&La?R(function(){return La.deriveBits(a,b,c)}).then(function(a){e(a)})["catch"](function(a){M("deriveBits",a.name)?g():f(a)}):void g()})}function ja(a,b,c){return new Promise(function(d,e){var f=N("deriveBits",a);if(f.name!==b.algorithm.name)throw new InvalidAccessError("Key not usable with this algorithm");if(-1===b.usages.indexOf("deriveBits"))throw new InvalidAccessError("baseKey.usages does not permit this operation");var g=Q("deriveBits",f,[f,b,c]);d(g)})}function ka(a,b){var c=b.prototype;b.prototype=Object.create(a.prototype);for(var d in c)b.prototype[d]=c[d];Object.defineProperty(b.prototype,"constructor",{enumerable:!1,value:b}),b._super=a.prototype}function la(b,c){var d;if(c&&Na.TextEncoder){var e=new TextEncoder("utf-8");d=e.encode(b)}else d=a.string_to_bytes(b,c),d=new Uint8Array(d.buffer.slice(0,d.length));return d}function ma(b,c){var d;if(Na.TextDecoder&&c){var e=new TextDecoder("utf-8",{fatal:!0});d=e.decode(b)}else d=a.bytes_to_string(b,c);return d}function na(a){var b=btoa(ma(a));return b.replace(/=+$/,"").replace(/\+/g,"-").replace(/\//g,"_")}function oa(a){return a.length%4===2?a+="==":a.length%4===3&&(a+="="),a=a.replace(/-/g,"+").replace(/_/g,"/"),la(atob(a))}function pa(a){for(var b="",c=0,d=a.length;d>c;){var e=a[c],f=e.toString(16);16>e&&(f="0"+f),b+=f,c++}return b}function qa(a){var b=a.length;1&b&&(a="0"+a,b++);for(var c=new Uint8Array(b/2),d=0;b>d;d+=2)c[d/2]=parseInt(a.substr(d,2),16);return c}function ra(a){return new Promise(function(b,c){var d=new FileReader;d.onload=function(a){b(new Uint8Array(a.target.result))},d.onerror=function(a){c(a.target.error)},d.readAsArrayBuffer(a)})}function sa(a){var b=new FileReaderSync;return new Uint8Array(b.readAsArrayBuffer(a))}function ta(a,b){return new Promise(function(c,d){c(ua(a,b))})}function ua(a,b){var c;return c=b?new Blob([a],{type:b}):new Blob([a])}function va(a){return la(JSON.stringify(a),!0)}function wa(a){var b;try{var c="JWK could not be parsed. Invalid data format";b=JSON.parse(ma(a,!0))}catch(d){throw new DataError(c)}if(!za(b))throw new DataError(c);return b}function xa(a,b){for(var c=!1,d=0;!c&&d<a.length;)-1===b.indexOf(a[d])&&(c=!0),d++;return c}function ya(a,b){return a.filter(function(a){return-1!==b.indexOf(a)})}function za(a){return a&&"object"==typeof a&&a.kty}function Aa(a){return Na.ArrayBuffer&&(a instanceof ArrayBuffer||ArrayBuffer.isView(a))}function Ba(a){var b;if(!Aa(a))throw new TypeError('"bufferSource" is not of type BufferSource');return b=a instanceof ArrayBuffer?a:a.buffer}function Ca(a){if(Na.ArrayBuffer&&a instanceof ArrayBuffer)return a.slice(0,a.byteLength);if(Na.ArrayBuffer&&ArrayBuffer.isView(a))return a.buffer.slice(a.byteOffset,a.byteOffset+a.byteLength);throw new TypeError('"data" is not of type ArrayBuffer or ArrayBufferView')}function Da(a){return"string"==typeof a}function Ea(a){return"number"==typeof a}function Fa(a){return"object"==typeof a}function Ga(a){return a instanceof Uint8Array}function Ha(a){return Da(a)||Fa(a)}function Ia(a){return Ha(a)}function Ja(a){return Na.CryptoKey&&a instanceof Na.CryptoKey||Na.Key&&a instanceof Key}function Ka(a){var b=!1;return a instanceof Ma.CryptoKey?b=!0:Fa(a)&&a.hasOwnProperty("type")&&a.hasOwnProperty("extractable")&&a.hasOwnProperty("algorithm")&&a.hasOwnProperty("usages")&&a.hasOwnProperty("_handle")&&(b=!0),b}var La,Ma={},Na="function"!=typeof importScripts?window:self,Oa=!!Na.msCrypto,Pa=!!Na.crypto,Qa=Na.crypto||Na.msCrypto;Qa&&(La=Qa.subtle),a&&(a.random.skipSystemRNGWarning=!0,a.random.allowWeak=!0),Ma.CryptoKey=b,Ma.getRandomValues=e,Ma.ext={},Ma.ext.pbkdf2={},Ma.ext.pbkdf2.deriveKeySha256=f,Ma.ext.sha256={},Ma.ext.sha256.base64URL=h,Ma.ext.sha256.hex=i,ka(F,j),j.prototype.init=function(a){if(j._super.init.call(this,a),!Aa(a.iv))throw new TypeError("AesGcmParams: iv: Missing or not a BufferSource");if(this.iv=a.iv,a.additionalData){if(!Aa(a.additionalData))throw new TypeError("AesGcmParams: additionalData: Not a BufferSource");this.additionalData=a.additionalData}if(a.tagLength){if(!Ea(a.tagLength))throw new TypeError("AesGcmParams: tagLength: Not a Number");this.tagLength=a.tagLength}return this},ka(F,m),m.prototype.init=function(a){if(m._super.init.call(this,a),!Ea(a.length))throw new TypeError("AesKeyGenParams: length: Missing or not a number");return this.length=a.length,this},Ma.subtle={},Ma.subtle.generateKey=U,Ma.subtle.exportKey=W,Ma.subtle.importKey=Y,Ma.subtle.decrypt=aa,Ma.subtle.encrypt=$,Ma.subtle.wrapKey=ca,Ma.subtle.unwrapKey=ea,Ma.subtle.deriveBits=ia,Ma.subtle.deriveKey=ga,Ma.subtle.digest=S,ka(F,r),r.prototype.init=function(a){if(r._super.init.call(this,a),!Aa(a.salt))throw new TypeError("Pbkdf2Params: salt: Missing or not a BufferSource");if(this.salt=a.salt,!Ea(a.iterations))throw new TypeError("Pbkdf2Params: iterations: Missing or not a number");if(this.iterations=a.iterations,!Ia(a.hash))throw new TypeError("Pbkdf2Params: hash: Missing or not a HashAlgorithmIdentifier");return this.hash=a.hash,this},ka(F,v),v.prototype.init=function(a){if(v._super.init.call(this,a),a.label){if(!Aa(a.label))throw new TypeError("RsaOapParams: label: Not a BufferSource");this.label=a.label}return this},ka(F,y),y.prototype.init=function(a){if(y._super.init.call(this,a),!Ea(a.modulusLength))throw new TypeError("RsaKeyGenParams: modulusLength: Missing or not a number");if(this.modulusLength=a.modulusLength,!a.publicExponent||!Ga(a.publicExponent))throw new TypeError("RsaKeyGenParams: publicExponent: Missing or not a BigInteger");return this.publicExponent=a.publicExponent,this},ka(y,z),z.prototype.init=function(a){if(z._super.init.call(this,a),!Ia(a.hash))throw new TypeError("RsaHashedKeyGenParms: hash: Missing or not a HashAlgorithmIdentifier");return this.hash=a.hash,this},ka(F,A),A.prototype.init=function(a){if(A._super.init.call(this,a),!Ia(a.hash))throw new TypeError("RsaHashedImportParams: hash: Missing or not a HashAlgorithmIdentifier");return this.hash=a.hash,this};var Ra={"RSASSA-PKCS1-v1_5":{"import":{"private":{jwk:!0,pkcs8:!0},"public":{jwk:!0,skpi:!0}},"export":{"private":{jwk:!0,pkcs8:!0},"public":{jwk:!0,skpi:!0}}},"RSA-PSS":{"import":{"private":{jwk:!0,pkcs8:!0},"public":{jwk:!0,skpi:!0}},"export":{"private":{jwk:!0,pkcs8:!0},"public":{jwk:!0,skpi:!0}}},"RSA-OAEP":{"import":{"private":{jwk:!0,pkcs8:!0},"public":{jwk:!0,skpi:!0}},"export":{"private":{jwk:!0,pkcs8:!0},"public":{jwk:!0,skpi:!0}}},ECDSA:{"import":{"private":{jwk:!0,pkcs8:!0},"public":{jwk:!0,skpi:!0}},"export":{"private":{jwk:!0,pkcs8:!0},"public":{jwk:!0,skpi:!0}}},ECDH:{"import":{"private":{jwk:!0,pkcs8:!0},"public":{raw:!0,jwk:!0,skpi:!0}},"export":{"private":{jwk:!0,pkcs8:!0},"public":{raw:!0,jwk:!0,skpi:!0}}},"AES-CTR":{"import":{secret:{raw:!0,jwk:!0}},"export":{secret:{raw:!0,jwk:!0}}},"AES-CBC":{"import":{secret:{raw:!0,jwk:!0}},"export":{secret:{raw:!0,jwk:!0}}},"AES-CMAC":{"import":{secret:{raw:!0,jwk:!0}},"export":{secret:{raw:!0,jwk:!0}}},"AES-GCM":{"import":{secret:{raw:!0,jwk:!0}},"export":{secret:{raw:!0,jwk:!0}}},"AES-CFB":{"import":{secret:{raw:!0,jwk:!0}},"export":{secret:{raw:!0,jwk:!0}}},"AES-KW":{"import":{secret:{raw:!0,jwk:!0}},"export":{secret:{raw:!0,jwk:!0}}},HMAC:{"import":{secret:{raw:!0,jwk:!0}},"export":{secret:{raw:!0,jwk:!0}}},DH:{"import":{"private":{pkcs8:!0},"public":{raw:!0,spki:!0}},"export":{"private":{raw:!0,pkcs8:!0},"public":{raw:!0,spki:!0}}},CONCAT:{"import":{secret:{raw:!0}}},"HKDF-CTR":{"import":{secret:{raw:!0}}},PBKDF2:{"import":{secret:{raw:!0}}}},Sa={encrypt:{"RSA-OAEP":w,"AES-GCM":k},decrypt:{"RSA-OAEP":x,"AES-GCM":l},sign:{},verify:{},digest:{"SHA-1":E,"SHA-256":E,"SHA-512":E},generateKey:{"RSASSA-PKCS1-v1_5":B,"RSA-PSS":B,"RSA-OAEP":B,"AES-CTR":n,"AES-CBC":n,"AES-CMAC":n,"AES-GCM":n,"AES-CFB":n,"AES-KW":n},getKeyLength:{"AES-CTR":q,"AES-CBC":q,"AES-CMAC":q,"AES-GCM":q,"AES-CFB":q,"AES-KW":q},deriveBits:{PBKDF2:u},importKey:{"RSASSA-PKCS1-v1_5":D,"RSA-PSS":D,"RSA-OAEP":D,"AES-CTR":p,"AES-CBC":p,"AES-CMAC":p,"AES-GCM":p,"AES-CFB":p,"AES-KW":p,PBKDF2:s},exportKey:{"RSASSA-PKCS1-v1_5":C,"RSA-PSS":C,"RSA-OAEP":C,"AES-CTR":o,"AES-CBC":o,"AES-CMAC":o,"AES-GCM":o,"AES-CFB":o,"AES-KW":o,PBKDF2:t},wrapKey:{},unwrapKey:{}},Ta={"default":["NotSupportedError"],encrypt:[],decrypt:[],sign:[],verify:[],digest:[],generateKey:["OperationError"],deriveKey:["OperationError"],deriveBits:["OperationError"],importKey:["Error","PBKDF2"],exportKey:[],wrapKey:[],unwrapKey:[]};return F.prototype.init=function(a){if(!a.name||!Da(a.name))throw new TypeError("Algorithm: name: Missing or not a string");return this.name=a.name,this},Ma.util={},Ma.util.bytesToBase64URL=na,Ma.util.base64URLToBytes=oa,Ma.util.bytesToHex=pa,Ma.util.hexToBytes=qa,Ma.util.stringToBytes=la,Ma.util.bytesToString=ma,Ma.util.blobToBytes=ra,Ma.util.bytesToBlob=ta,Ma.util.blobToBytesSync=sa,Ma.util.bytesToBlobSync=ua,!function(){function a(a){var b=Error.apply(this,arguments);this.name="NotSupportedError",this.message=b.message,this.stack=b.stack}function b(a){var b=Error.apply(this,arguments);this.name="InvalidAccessError",this.message=b.message,this.stack=b.stack}function c(a){var b=Error.apply(this,arguments);this.name="DataError",this.message=b.message,this.stack=b.stack}function d(a){var b=Error.apply(this,arguments);this.name="OperationError",this.message=b.message,this.stack=b.stack}Na.NotSupportedError||(a.prototype=Object.create(Error.prototype),a.prototype.constructor=a,Na.NotSupportedError=a),Na.InvalidAccessError||(b.prototype=Object.create(Error.prototype),b.prototype.constructor=b,Na.InvalidAccessError=b),Na.DataError||(c.prototype=Object.create(Error.prototype),c.prototype.constructor=c,Na.DataError=c),Na.OperationError||(d.prototype=Object.create(Error.prototype),d.prototype.constructor=d,Na.OperationError=d)}(),!function(){!Na.Promise&&Na.ES6Promise&&ES6Promise.polyfill()}(),Ma});
//# sourceMappingURL=web-crypto.min.js.map